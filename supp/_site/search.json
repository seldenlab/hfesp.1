[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Did intended firing method condition the morphology of Caddo bottles?",
    "section": "",
    "text": "Each [Caddo] clan had its own shape to make its pottery. One clan never thought of making anything the same pattern of another clan. You could tell who made the pottery by the shape (Cassaway 1937, 395)."
  },
  {
    "objectID": "index.html#keywords",
    "href": "index.html#keywords",
    "title": "Did intended firing method condition the morphology of Caddo bottles?",
    "section": "Keywords",
    "text": "Keywords\nCaddo; NAGPRA; ceramic; pottery; 3D; computational archaeology; museum studies; digital humanities; non-Western art history; STEM; STEAM"
  },
  {
    "objectID": "index.html#firing",
    "href": "index.html#firing",
    "title": "Did intended firing method condition the morphology of Caddo bottles?",
    "section": "Firing",
    "text": "Firing\nEach of the 30 vessels was scanned (3D) with a Creaform GoSCAN20 to capture color and geometry. Following data collection, each scan was exported as an .obj file, which includes a bitmap image of the surface color of each vessel. Images were subsequently transferred to a transparent background in Photoshop in preparation for analysis using the colordistance package in R (R Core Development Team, 2023; Weller and Westneat 2019). Upper and lower limits of the color range were determined based on colors present in the sample. Ten thousand randomly selected pixels were plotted from each image, a histogram binning method was used to group similar colors for each specimen, and pairwise distances between histograms were computed using earth mover’s distance (Rubner and Tomasi 2001; Weller and Westneat 2019).\n\nknitr::include_graphics('./img/fig2.png')\n\n\n\n\nColor binning process for a single object; adapted from Weller and Westneat (2019:Figure 2). In a, image of a Smithport Plain bottle with a transparent background; b, 3D scatterplot of 10,000 non-background pixels in RGB color space; c, clusters from the histogram in b displayed in RGB color space; and d, histogram showing the proportion of non-background pixels assigned to each of eight bins.\n\n\n\n\nThe elliptical bifaces were coded as ColorGroup A (reduced) and ColorGroup B (oxidized). To test whether the color groups identified by the clusters differ, the color distance matrix was exported and joined with the categorical data. Those data were used in a permutational multivariate analysis of variance in the vegan package to evaluate whether vessel colors differs by firing method (permutations: 10,000; Rsq: 0.4324; Pr(>F): 9.999e-05). A neighbor-joining tree was generated using the color distance matrix to illustrate color differences between oxidized and reduced vessels.\n\nknitr::include_graphics('./img/fig3.png')\n\n\n\n\nNeighbor-joining tree illustrating the 3D texture (color) data for oxidized (left) and reduced (right) Caddo bottles."
  },
  {
    "objectID": "index.html#morphology",
    "href": "index.html#morphology",
    "title": "Did intended firing method condition the morphology of Caddo bottles?",
    "section": "Morphology",
    "text": "Morphology\nLandmark data were aligned to a global coordinate system (Bookstein et al. 1999; Gunz, Mitteroecker, and Bookstein 2005; Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Bookstein 1986; Rohlf and Slice 1990; Rohlf 1999) in R using the geomorph and RRPP packages (Adams and Collyer 2015; Collyer and Adams 2018; Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates and rotates the coordinate data to allow for comparisons among objects, while also scaling each bottle using unit-centroid size—the square root of the sum of squared distances from each landmark to the specimen’s centroid (Chapman 1990; Dryden and Mardia 1998; Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Dryden and Mardia 1993; Kent and Mardia 2001; Rohlf 1999; Slice 2001).\nPrincipal components analysis (Jolliffe 2002) was used to visualize shape variation among the bottles, and the scatterplot represents the dispersion of shapes in tangent space (Adams, Rohlf, and Slice 2013; Bookstein 1991; O’Higgins and Jones 1998; Rohlf and Marcus 1993). Shape ranges described by each principal axis are commonly visualized using thin-plate spline warping of a reference mesh (Klingenberg 2013; Sherratt et al. 2014).\n\nknitr::include_graphics('./img/fig4.png')\n\n\n\n\nPrincipal components analysis plot (PC1/PC2) for Hickory Engraved and Smithport Plain bottles by firing category, where gray indicates bottles fired in a reduced environment, and orange from an oxidized environment, plotted with warp grids for the first two principal components.\n\n\n\n\nTo assess whether shape and size differs by ColorGroup, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\nknitr::include_graphics('img/fig5.png')\n\n\n\n\nMean shapes summarizing variation in Hickory Engraved and Smithport Plain bottles fired in oxidized (left) and reduced (right) environments. In the comparison, gray spheres articulate with oxidized vessels, and black spheres with reduced.\n\n\n\n\nResults demonstrate a significant difference in size—but not shape—by type (RRPP: 10,000; Rsq: 0.14223; Pr(>F): 0.0373), where the Hickory Engraved bottles were found to be larger than the Smithport Plain bottles. In the analysis of bottle morphology by firing method, vessels were found to differ significantly in shape (RRPP: 10,000; Rsq: 0.11456; Pr(>F): 0.0275), but not size (RRPP: 10,000; Rsq: 0.00224; Pr(>F): 0.8008)."
  },
  {
    "objectID": "c01-color.html",
    "href": "c01-color.html",
    "title": "Firing",
    "section": "",
    "text": "# compare colors\nlibrary(here)\nlibrary(colordistance)\nlibrary(recolorize)\nlibrary(tidyverse)\nlibrary(vegan)\nlibrary(ape)\nlibrary(ggConvexHull)\nlibrary(wesanderson)\n\n# get image paths\nimages <- colordistance::getImagePaths('out')\n\n# generate color distance matrix\ncdm <- imageClusterPipeline(images,\n                            cluster.method = 'hist',\n                            distance.method = 'emd',\n                            lower = FALSE,\n                            upper = FALSE,\n                            hist.bins = 3,\n                            color.space = 'lab',\n                            ref.white = 'D65',\n                            plot.bins = TRUE,\n                            pausing = FALSE\n                            )\n\n\n  |                                                                            \n  |                                                                      |   0%\n\n\n\n\n\n\n  |                                                                            \n  |==                                                                    |   3%\n\n\n\n\n\n\n  |                                                                            \n  |=====                                                                 |   7%\n\n\n\n\n\n\n  |                                                                            \n  |=======                                                               |  10%\n\n\n\n\n\n\n  |                                                                            \n  |=========                                                             |  13%\n\n\n\n\n\n\n  |                                                                            \n  |============                                                          |  17%\n\n\n\n\n\n\n  |                                                                            \n  |==============                                                        |  20%\n\n\n\n\n\n\n  |                                                                            \n  |================                                                      |  23%\n\n\n\n\n\n\n  |                                                                            \n  |===================                                                   |  27%\n\n\n\n\n\n\n  |                                                                            \n  |=====================                                                 |  30%\n\n\n\n\n\n\n  |                                                                            \n  |=======================                                               |  33%\n\n\n\n\n\n\n  |                                                                            \n  |==========================                                            |  37%\n\n\n\n\n\n\n  |                                                                            \n  |============================                                          |  40%\n\n\n\n\n\n\n  |                                                                            \n  |==============================                                        |  43%\n\n\n\n\n\n\n  |                                                                            \n  |=================================                                     |  47%\n\n\n\n\n\n\n  |                                                                            \n  |===================================                                   |  50%\n\n\n\n\n\n\n  |                                                                            \n  |=====================================                                 |  53%\n\n\n\n\n\n\n  |                                                                            \n  |========================================                              |  57%\n\n\n\n\n\n\n  |                                                                            \n  |==========================================                            |  60%\n\n\n\n\n\n\n  |                                                                            \n  |============================================                          |  63%\n\n\n\n\n\n\n  |                                                                            \n  |===============================================                       |  67%\n\n\n\n\n\n\n  |                                                                            \n  |=================================================                     |  70%\n\n\n\n\n\n\n  |                                                                            \n  |===================================================                   |  73%\n\n\n\n\n\n\n  |                                                                            \n  |======================================================                |  77%\n\n\n\n\n\n\n  |                                                                            \n  |========================================================              |  80%\n\n\n\n\n\n\n  |                                                                            \n  |==========================================================            |  83%\n\n\n\n\n\n\n  |                                                                            \n  |=============================================================         |  87%\n\n\n\n\n\n\n  |                                                                            \n  |===============================================================       |  90%\n\n\n\n\n\n\n  |                                                                            \n  |=================================================================     |  93%\n\n\n\n\n\n\n  |                                                                            \n  |====================================================================  |  97%\n\n\n\n\n\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n\n# replace NAs with 0\ncdm[is.na(cdm)] = 0\n# export color distance matrix\nwrite.csv(cdm, file = 'distance_matrix.csv')"
  },
  {
    "objectID": "c01-color.html#permutational-manova",
    "href": "c01-color.html#permutational-manova",
    "title": "Firing",
    "section": "Permutational MANOVA",
    "text": "Permutational MANOVA\n\n#preliminaries\n# import qual data\nhfesp.data <- read.csv('qdata.csv',\n                       header = TRUE,\n                       as.is = TRUE)\n\n# import color distance matrix\nc.data <- read.csv('distance_matrix.csv',\n                   header = TRUE,\n                   as.is = TRUE)\n\n# cdm rev sans .png\nc.data2 <- as.data.frame(c.data %>% \n    select(c(CNO.Pohler.2002.01.18.png:UArk_BattleMound.55.15.9.png)) %>% \n      rename('CNO-Pohler-2002-01-18' = CNO.Pohler.2002.01.18.png,\n             'CNO-Pohler-2002-01-20' = CNO.Pohler.2002.01.20.png,\n             'CNO-Pohler-2002-01-23' = CNO.Pohler.2002.01.23.png,\n             'CNO-Pohler-2002-01-27' = CNO.Pohler.2002.01.27.png,\n             'LSEM-Haley-HFE1' = LSEM.Haley.HFE1.png,\n             'LSEM-Haley-HFE2' = LSEM.Haley.HFE2.png,\n             'LSEM-Haley-HFE3' = LSEM.Haley.HFE3.png,\n             'LSEM-Haley-HFE4' = LSEM.Haley.HFE4.png,\n             'LSEM-Haley-HFE5' = LSEM.Haley.HFE5.png,\n             'NSU-AllenPlantation-142' = NSU.AllenPlantation.142.png,\n             'NSU-Belcher-404' = NSU.Belcher.404.png,\n             'NSU-Gahagan-955' = NSU.Gahagan.955.png,\n             'NSU-Gahagan-956' = NSU.Gahagan.956.png,\n             'NSU-SmithportLanding-152' = NSU.SmithportLanding.152.png,\n             'NSU-SmithportLanding-157' = NSU.SmithportLanding.157.png,\n             'NSU-SmithportLanding-95' = NSU.SmithportLanding.95.png,\n             'NSU-SmithportLanding-96' = NSU.SmithportLanding.96.png,\n             'TARL-41BW3-6-1-7-FS7' = TARL.41BW3.6.1.7.FS7.png,\n             'TARL-41BW4-341-427' = TARL.41BW4.341.427.png,\n             'TARL-41BW4-341-464' = TARL.41BW4.341.464.png,\n             'TARL-41BW4-6-2-132' = TARL.41BW4.6.2.132.png,\n             'TARL-41BW4-6-2-67' = TARL.41BW4.6.2.67.png,\n             'TARL-41BW4-6-2-78' = TARL.41BW4.6.2.78.png,\n             'TARL-41CE19-2015-1' = TARL.41CE19.2015.1.png,\n             'TARL-41RR3-2' = TARL.41RR3.2.png,\n             'UArk-Burrows-55-19-2' = UArk.Burrows.55.19.2.png,\n             'UArk-Crenshaw-55-1-10' = UArk.Crenshaw.55.1.10.png,\n             'UArk-Crenshaw-55-1-4' = UArk.Crenshaw.55.1.4.png,\n             'UArk-Crenshaw-55-1-43' = UArk.Crenshaw.55.1.43.png,\n             'UArk_BattleMound-55-15-9' = UArk_BattleMound.55.15.9.png)\n)\n\nc.data2$X <- colnames(c.data2)\nbottle <- full_join(hfesp.data, c.data2, by = 'X') # left join by specimen number\nbottle.dist <- bottle[,6:35] # color distance matrix\nset.seed(10) # make results reproducible\n\n# model: color as a function of firing category (oxidized v. reduced)\nbottle.colour <- adonis2(bottle.dist ~ ColorGroup,\n                         data = bottle,\n                         permutations = 10000,\n                         method = 'bray')\n\n## does color differ by firing category?\nbottle.colour\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 10000\n\nadonis2(formula = bottle.dist ~ ColorGroup, data = bottle, permutations = 10000, method = \"bray\")\n           Df SumOfSqs  R2  F    Pr(>F)    \nColorGroup  1  0.79043 0.5 28 9.999e-05 ***\nResidual   28  0.79044 0.5                 \nTotal      29  1.58087 1.0                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "c01-color.html#neighbor-joining-tree",
    "href": "c01-color.html#neighbor-joining-tree",
    "title": "Firing",
    "section": "Neighbor-Joining Tree",
    "text": "Neighbor-Joining Tree\n\n# define add_image function\nadd_image <- function(obj,\n                      x = NULL,\n                      y = NULL,\n                      width = NULL,\n                      interpolate = TRUE,\n                      angle = 0) {\n  \n  # get current plotting window parameters:\n  usr <- graphics::par()$usr\n  pin <- graphics::par()$pin\n  \n  # image dimensions and scaling factor:\n  imdim <- dim(obj)\n  sf <- imdim[1] / imdim[2]\n  \n  # set the width of the image (relative to x-axis)\n  w <- width / (usr[2] - usr[1]) * pin[1]\n  h <- w * sf\n  hu <- h / pin[2] * (usr[4] - usr[3])\n  \n  # plot the image\n  graphics::rasterImage(image = obj,\n                        xleft = x - (width / 2), xright = x + (width / 2),\n                        ybottom = y - (hu / 2), ytop = y + (hu/2),\n                        interpolate = interpolate,\n                        angle = angle)\n}\n\n# c.data2 sans 'X'\nc.data2 <- c.data2 %>% \n  select('CNO-Pohler-2002-01-18':'UArk_BattleMound-55-15-9')\n# column names to ID\nrownames(c.data2) <- colnames(c.data2)\n\n# neighbor-joining tree\ntree <- nj(as.dist(c.data2))\n# plot tree\nplot(tree,\n     show.tip.label = FALSE,\n     direction = 'upward')\n\n# get parameters from plotting environment\nlastPP <- get('last_plot.phylo', \n              envir = .PlotPhyloEnv)\n\n# get xy coordinates of tips\nntip <- lastPP$Ntip\n\n# first n values are tips/remaining values are node coordinates\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip])\n\n# get image names\nimnames <- tools::file_path_sans_ext(basename(images))\n\n# get tip labels\ntipnames <- tree$tip.label\n\n# check that images are in correct order:\nimage_order <- match(tipnames, imnames)\nimages <- images[image_order]\n\n## final plot\npar(mar = rep(0, 4))\nplot(tree, show.tip.label = FALSE, direction = 'upward')\n\n# parameters from plotting environment\nlastPP <- get('last_plot.phylo', envir = .PlotPhyloEnv)\n\n# xy coordinates of tips\nntip <- lastPP$Ntip\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip]) \n\nfor (i in 1:length(images)) {\n  add_image(png::readPNG(images[i]),\n            x = xy[i, 1],\n            y = xy[i, 2], \n            width = 2)\n}"
  },
  {
    "objectID": "c02-morphology1.html",
    "href": "c02-morphology1.html",
    "title": "Morphology by Type",
    "section": "",
    "text": "# load required analysis packages\nlibrary(here)\nlibrary(StereoMorph)\nlibrary(geomorph)\nlibrary(tidyverse)\nlibrary(wesanderson)\nlibrary(ggplot2)\n\n## load GM data\nsource('readmulti.csv.R')\n\n# read .csv files\nsetwd('./data')\nfilelist <- list.files(pattern = '.csv')\ncoords <- readmulti.csv(filelist)\nsetwd('../')\n\n# read qualitative data\nqdata <- read.csv('qdata.csv', \n                  header = TRUE, \n                  row.names = 1)\nqdata <- qdata[match(dimnames(coords)[[3]], rownames(qdata)),]"
  },
  {
    "objectID": "c02-morphology1.html#generalized-procrustes-analysis",
    "href": "c02-morphology1.html#generalized-procrustes-analysis",
    "title": "Morphology by Type",
    "section": "Generalized Procrustes Analysis",
    "text": "Generalized Procrustes Analysis\nLandmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Rohlf and Slice 1990) performed in R (R Core Development Team, 2023) using the geomorph library (Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001).\n\n# gpa\nY.gpa <- gpagen(coords, print.progress = FALSE)\n\n# plot\nplot(Y.gpa)\n\n# geomorph data frame\ngdf <- geomorph.data.frame(shape = Y.gpa$coords, \n                           size = Y.gpa$Csize,\n                           type = qdata$type)\n\n# add centroid size to qdata\nqdata$csz <- Y.gpa$Csize"
  },
  {
    "objectID": "c02-morphology1.html#boxplot-centroid-size",
    "href": "c02-morphology1.html#boxplot-centroid-size",
    "title": "Morphology by Type",
    "section": "Boxplot (centroid size)",
    "text": "Boxplot (centroid size)\n\n# attributes\ncsz <- qdata$csz\ntype <- qdata$typeroup\n\n# palette\npal = wes_palette('Moonrise2')\n\n# boxplot of Perdiz arrow points by region\nggplot(qdata, aes(x = type, y = csz, color = type)) +\n  geom_boxplot() +\n  geom_dotplot(binaxis = 'y', stackdir = 'center', dotsize = 0.3) +\n  scale_color_manual(values = pal) +\n  theme(legend.position = 'none') +\n  labs(x = 'Type', y = 'Centroid Size')\n\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`."
  },
  {
    "objectID": "c02-morphology1.html#principal-components-analysis",
    "href": "c02-morphology1.html#principal-components-analysis",
    "title": "Morphology by Type",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\nPrincipal components analysis (Jolliffe 2002) was used to visualize shape variation among the Perdiz arrow points. The shape changes described by each principal axis are commonly visualized using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014).\n\n# principal components analysis\npca<-gm.prcomp(Y.gpa$coords)\nsummary(pca)\n\n\nOrdination type: Principal Component Analysis \nCentering by OLS mean\nOrthogonal projection of OLS residuals\nNumber of observations: 30 \nNumber of vectors 29 \n\nImportance of Components:\n                             Comp1       Comp2        Comp3        Comp4\nEigenvalues            0.008667521 0.003274512 0.0008528696 0.0005560839\nProportion of Variance 0.623710770 0.235632396 0.0613720998 0.0400155396\nCumulative Proportion  0.623710770 0.859343167 0.9207152664 0.9607308060\n                              Comp5        Comp6        Comp7        Comp8\nEigenvalues            0.0001808081 8.839522e-05 7.891835e-05 6.675011e-05\nProportion of Variance 0.0130108643 6.360879e-03 5.678928e-03 4.803307e-03\nCumulative Proportion  0.9737416702 9.801025e-01 9.857815e-01 9.905848e-01\n                              Comp9       Comp10       Comp11       Comp12\nEigenvalues            5.089464e-05 2.225546e-05 1.590259e-05 1.111104e-05\nProportion of Variance 3.662354e-03 1.601492e-03 1.144343e-03 7.995456e-04\nCumulative Proportion  9.942471e-01 9.958486e-01 9.969930e-01 9.977925e-01\n                             Comp13       Comp14       Comp15       Comp16\nEigenvalues            7.243332e-06 5.660051e-06 4.146274e-06 3.075896e-06\nProportion of Variance 5.212268e-04 4.072946e-04 2.983640e-04 2.213401e-04\nCumulative Proportion  9.983137e-01 9.987210e-01 9.990194e-01 9.992407e-01\n                             Comp17       Comp18       Comp19       Comp20\nEigenvalues            2.082742e-06 1.879604e-06 1.402580e-06 1.162853e-06\nProportion of Variance 1.498731e-04 1.352554e-04 1.009290e-04 8.367838e-05\nCumulative Proportion  9.993906e-01 9.995259e-01 9.996268e-01 9.997105e-01\n                             Comp21       Comp22       Comp23       Comp24\nEigenvalues            1.051189e-06 8.485087e-07 6.830816e-07 5.594955e-07\nProportion of Variance 7.564307e-05 6.105829e-05 4.915423e-05 4.026104e-05\nCumulative Proportion  9.997861e-01 9.998472e-01 9.998963e-01 9.999366e-01\n                             Comp25       Comp26       Comp27       Comp28\nEigenvalues            2.994319e-07 2.220144e-07 1.600565e-07 1.198621e-07\nProportion of Variance 2.154698e-05 1.597605e-05 1.151759e-05 8.625218e-06\nCumulative Proportion  9.999581e-01 9.999741e-01 9.999856e-01 9.999943e-01\n                             Comp29\nEigenvalues            7.972654e-08\nProportion of Variance 5.737084e-06\nCumulative Proportion  1.000000e+00\n\n# set plot parameters\npch.gps <- c(1,3)[as.factor(qdata$type)]\ncol.gps <- wes_palette('Moonrise2')[as.factor(qdata$type)]\ncol.hull <- c('#C27D38','#798E87')\n\n# plot pca by merged\npc.plot <- plot(pca, \n                asp = 1,\n                pch = pch.gps,\n                col = col.gps)\nshapeHulls(pc.plot, \n           groups = qdata$type,\n           group.cols = col.hull)\n\n\n\n# plot x/y maxima/minima\n## x - minima\nmean.shape <- mshape(Y.gpa$coords)\nplotRefToTarget(pca$shapes$shapes.comp1$min, \n                mean.shape)\n\n\n\n## x - maxima\nplotRefToTarget(pca$shapes$shapes.comp1$max, \n                mean.shape)\n\n\n\n## y - minima\nplotRefToTarget(pca$shapes$shapes.comp2$min, \n                mean.shape)\n\n\n\n## y - maxima\nplotRefToTarget(pca$shapes$shapes.comp2$max, \n                mean.shape)"
  },
  {
    "objectID": "c02-morphology1.html#procrustes-anova",
    "href": "c02-morphology1.html#procrustes-anova",
    "title": "Morphology by Type",
    "section": "Procrustes ANOVA",
    "text": "Procrustes ANOVA\nTo assess whether shape and size differ by size class, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\n# ANOVA\n# shape\nfit.sh <- procD.lm(shape ~ type,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# shape as a function of firing practice?\nanova(fit.sh)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n          Df      SS       MS     Rsq      F       Z Pr(>F)\ntype       1 0.02333 0.023328 0.05789 1.7204 0.97793 0.1684\nResiduals 28 0.37968 0.013560 0.94211                      \nTotal     29 0.40300                                       \n\nCall: procD.lm(f1 = shape ~ type, iter = 9999, data = gdf, print.progress = FALSE)\n\n# size\nfit.sz <- procD.lm(size ~ type,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# size as a function of firing practice?\nanova(fit.sz)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n          Df     SS    MS     Rsq      F      Z Pr(>F)  \ntype       1  82869 82869 0.14223 4.6429 1.6989 0.0373 *\nResiduals 28 499763 17849 0.85777                       \nTotal     29 582632                                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCall: procD.lm(f1 = size ~ type, iter = 9999, data = gdf, print.progress = FALSE)"
  },
  {
    "objectID": "c03-morphology2.html",
    "href": "c03-morphology2.html",
    "title": "Morphology by Firing Group",
    "section": "",
    "text": "# load required analysis packages\nlibrary(here)\nlibrary(StereoMorph)\nlibrary(geomorph)\nlibrary(tidyverse)\nlibrary(wesanderson)\nlibrary(ggplot2)\n\n## load GM data\nsource('readmulti.csv.R')\n\n# read .csv files\nsetwd('./data')\nfilelist <- list.files(pattern = '.csv')\ncoords <- readmulti.csv(filelist)\nsetwd('../')\n\n# read qualitative data\nqdata <- read.csv('qdata.csv', \n                  header = TRUE, \n                  row.names = 1)\nqdata <- qdata[match(dimnames(coords)[[3]], rownames(qdata)),]"
  },
  {
    "objectID": "c03-morphology2.html#generalized-procrustes-analysis",
    "href": "c03-morphology2.html#generalized-procrustes-analysis",
    "title": "Morphology by Firing Group",
    "section": "Generalized Procrustes Analysis",
    "text": "Generalized Procrustes Analysis\nLandmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Rohlf and Slice 1990) performed in R (R Core Development Team, 2023) using the geomorph library (Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001).\n\n# gpa\nY.gpa <- gpagen(coords, print.progress = FALSE)\n\n# plot\nplot(Y.gpa)\n\n# geomorph data frame\ngdf <- geomorph.data.frame(shape = Y.gpa$coords, \n                           size = Y.gpa$Csize,\n                           ColorGroup = qdata$ColorGroup)\n\n# add centroid size to qdata\nqdata$csz <- Y.gpa$Csize"
  },
  {
    "objectID": "c03-morphology2.html#boxplot-centroid-size",
    "href": "c03-morphology2.html#boxplot-centroid-size",
    "title": "Morphology by Firing Group",
    "section": "Boxplot (centroid size)",
    "text": "Boxplot (centroid size)\n\n# attributes\ncsz <- qdata$csz\nColorG <- qdata$ColorGroup\n\n# palette\npal = wes_palette('Moonrise2')\n\n# boxplot of Perdiz arrow points by region\nggplot(qdata, aes(x = ColorG, y = csz, color = ColorG)) +\n  geom_boxplot() +\n  geom_dotplot(binaxis = 'y', stackdir = 'center', dotsize = 0.3) +\n  scale_color_manual(values = pal) +\n  theme(legend.position = 'none') +\n  labs(x = 'ColorGroup', y = 'Centroid Size')\n\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`."
  },
  {
    "objectID": "c03-morphology2.html#principal-components-analysis",
    "href": "c03-morphology2.html#principal-components-analysis",
    "title": "Morphology by Firing Group",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\nPrincipal components analysis (Jolliffe 2002) was used to visualize shape variation among the Perdiz arrow points. The shape changes described by each principal axis are commonly visualized using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014).\n\n# principal components analysis\npca<-gm.prcomp(Y.gpa$coords)\nsummary(pca)\n\n\nOrdination type: Principal Component Analysis \nCentering by OLS mean\nOrthogonal projection of OLS residuals\nNumber of observations: 30 \nNumber of vectors 29 \n\nImportance of Components:\n                             Comp1       Comp2        Comp3        Comp4\nEigenvalues            0.008667521 0.003274512 0.0008528696 0.0005560839\nProportion of Variance 0.623710770 0.235632396 0.0613720998 0.0400155396\nCumulative Proportion  0.623710770 0.859343167 0.9207152664 0.9607308060\n                              Comp5        Comp6        Comp7        Comp8\nEigenvalues            0.0001808081 8.839522e-05 7.891835e-05 6.675011e-05\nProportion of Variance 0.0130108643 6.360879e-03 5.678928e-03 4.803307e-03\nCumulative Proportion  0.9737416702 9.801025e-01 9.857815e-01 9.905848e-01\n                              Comp9       Comp10       Comp11       Comp12\nEigenvalues            5.089464e-05 2.225546e-05 1.590259e-05 1.111104e-05\nProportion of Variance 3.662354e-03 1.601492e-03 1.144343e-03 7.995456e-04\nCumulative Proportion  9.942471e-01 9.958486e-01 9.969930e-01 9.977925e-01\n                             Comp13       Comp14       Comp15       Comp16\nEigenvalues            7.243332e-06 5.660051e-06 4.146274e-06 3.075896e-06\nProportion of Variance 5.212268e-04 4.072946e-04 2.983640e-04 2.213401e-04\nCumulative Proportion  9.983137e-01 9.987210e-01 9.990194e-01 9.992407e-01\n                             Comp17       Comp18       Comp19       Comp20\nEigenvalues            2.082742e-06 1.879604e-06 1.402580e-06 1.162853e-06\nProportion of Variance 1.498731e-04 1.352554e-04 1.009290e-04 8.367838e-05\nCumulative Proportion  9.993906e-01 9.995259e-01 9.996268e-01 9.997105e-01\n                             Comp21       Comp22       Comp23       Comp24\nEigenvalues            1.051189e-06 8.485087e-07 6.830816e-07 5.594955e-07\nProportion of Variance 7.564307e-05 6.105829e-05 4.915423e-05 4.026104e-05\nCumulative Proportion  9.997861e-01 9.998472e-01 9.998963e-01 9.999366e-01\n                             Comp25       Comp26       Comp27       Comp28\nEigenvalues            2.994319e-07 2.220144e-07 1.600565e-07 1.198621e-07\nProportion of Variance 2.154698e-05 1.597605e-05 1.151759e-05 8.625218e-06\nCumulative Proportion  9.999581e-01 9.999741e-01 9.999856e-01 9.999943e-01\n                             Comp29\nEigenvalues            7.972654e-08\nProportion of Variance 5.737084e-06\nCumulative Proportion  1.000000e+00\n\n# set plot parameters\npch.gps <- c(1,3)[as.factor(qdata$ColorGroup)]\ncol.gps <- wes_palette('Moonrise2')[as.factor(qdata$ColorGroup)]\ncol.hull <- c('#798E87','#C27D38')\n\n# plot pca by merged\npc.plot <- plot(pca, \n                asp = 1,\n                pch = pch.gps,\n                col = col.gps)\nshapeHulls(pc.plot, \n           groups = qdata$ColorGroup,\n           group.cols = col.hull)\n\n\n\n# plot x/y maxima/minima\n## x - minima\nmean.shape <- mshape(Y.gpa$coords)\nplotRefToTarget(pca$shapes$shapes.comp1$min, \n                mean.shape)\n\n\n\n## x - maxima\nplotRefToTarget(pca$shapes$shapes.comp1$max, \n                mean.shape)\n\n\n\n## y - minima\nplotRefToTarget(pca$shapes$shapes.comp2$min, \n                mean.shape)\n\n\n\n## y - maxima\nplotRefToTarget(pca$shapes$shapes.comp2$max, \n                mean.shape)"
  },
  {
    "objectID": "c03-morphology2.html#procrustes-anova",
    "href": "c03-morphology2.html#procrustes-anova",
    "title": "Morphology by Firing Group",
    "section": "Procrustes ANOVA",
    "text": "Procrustes ANOVA\nTo assess whether shape and size differ by size class, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\n# ANOVA\n# shape\nfit.sh <- procD.lm(shape ~ ColorGroup,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# shape as a function of firing practice?\nanova(fit.sh)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n           Df      SS        MS     Rsq      F        Z Pr(>F)\nColorGroup  1 0.00561 0.0056096 0.01392 0.3952 -0.66654 0.7414\nResiduals  28 0.39739 0.0141927 0.98608                       \nTotal      29 0.40300                                         \n\nCall: procD.lm(f1 = shape ~ ColorGroup, iter = 9999, data = gdf, print.progress = FALSE)\n\n# size\nfit.sz <- procD.lm(size ~ ColorGroup,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# size as a function of firing practice?\nanova(fit.sz)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n           Df     SS      MS     Rsq      F        Z Pr(>F)\nColorGroup  1   7329  7328.9 0.01258 0.3567 -0.12102 0.5571\nResiduals  28 575304 20546.6 0.98742                       \nTotal      29 582632                                       \n\nCall: procD.lm(f1 = size ~ ColorGroup, iter = 9999, data = gdf, print.progress = FALSE)"
  }
]