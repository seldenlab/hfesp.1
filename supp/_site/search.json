[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Was Caddo bottle morphology conditioned by firing intent?",
    "section": "",
    "text": "“The question of questions for mankind—the problem which underlies all others, and is more deeply interesting than any other—is the ascertainment of the place which man occupies in nature, and of his relation to the universe of things.” –H. Thomas Henry Huxley, Man’s Place in Nature"
  },
  {
    "objectID": "index.html#keywords",
    "href": "index.html#keywords",
    "title": "Was Caddo bottle morphology conditioned by firing intent?",
    "section": "Keywords",
    "text": "Keywords\nCaddo; NAGPRA; ceramic; pottery; 3D; computational archaeology; museum studies; digital humanities; non-Western art history"
  },
  {
    "objectID": "index.html#color",
    "href": "index.html#color",
    "title": "Was Caddo bottle morphology conditioned by firing intent?",
    "section": "Color",
    "text": "Color\nEach of the 30 vessels was scanned (3D) with a Creaform GoSCAN20 to capture color and geometry. Following data collection, scans were processed, and each was exported as an .obj file, which includes a bitmap image of the color for the entirety of the vessel. Images were subsequently transferred to a transparent background in Photoshop, and edited to remove elements associated with reconstruction and refits (i.e., plaster, labels, and lines where pieces were joined) in preparation for analysis using the colordistance package in R (R Core Development Team, 2023; Weller and Westneat 2019). All images were converted from RGB to CIE Lab color space using the D65 (indirect sunlight) reference white as the default for color conversion, and the upper and lower limits of the color range were determined based on colors present in the sample. Ten thousand randomly selected pixels were plotted from each image, and a histogram binning method was used to group similar colors for each specimen. Pairwise distances between histograms were computed using earth mover’s distance (Rubner and Tomasi 2001). The distance matrix was exported for use in a permutational multivariate analysis of variance (MANOVA) using the vegan package to evaluate whether vessel color from each firing category differs (permutations = 10,000; Rsq = 0.31881; Pr(>F) = 9.999e-05). A neighbor-joining tree was used to illustrate .\n\nknitr::include_graphics('./img/fig2.png')\n\n\n\n\nColor binning process for a single object; adapted from Weller and Westneat (2019:Figure 2). In a, image of a Smithport Plain bottle with a transparent background; b, 3D scatterplot of 10,000 non-background pixels in CIE Lab color space; c, clusters from the histogram in b displayed in CIE Lab color space; and d, histogram showing the proportion of non-background pixels assigned to each of eight bins.\n\n\n\n\n\nknitr::include_graphics('./img/fig3.png')\n\n\n\n\nNeighbor-joining tree illustrating the 3D texture (color) data for oxidized (left) and reduced (right) Caddo bottles."
  },
  {
    "objectID": "index.html#morphology",
    "href": "index.html#morphology",
    "title": "Was Caddo bottle morphology conditioned by firing intent?",
    "section": "Morphology",
    "text": "Morphology\nLandmark data were aligned to a global coordinate system (Bookstein et al. 1999; Gunz, Mitteroecker, and Bookstein 2005; Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Bookstein 1986; Rohlf and Slice 1990; Rohlf 1999) in R using the geomorph and RRPP packages (Adams and Collyer 2015; Collyer and Adams 2018; Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates and rotates the coordinate data to allow for comparisons among objects, while also scaling each bottle using unit-centroid size—the square root of the sum of squared distances from each landmark to the specimen’s centroid (Chapman 1990; Dryden and Mardia 1998; Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Dryden and Mardia 1993; Kent and Mardia 2001; Rohlf 1999; Slice 2001).\nPrincipal components analysis (Jolliffe 2002) was used to visualize shape variation among the bottles, and the scatterplot represents the dispersion of shapes in tangent space (Adams, Rohlf, and Slice 2013; Bookstein 1991; O’Higgins and Jones 1998; Rohlf and Marcus 1993). Shape ranges described by each principal axis are commonly visualized using thin-plate spline warping of a reference mesh (Klingenberg 2013; Sherratt et al. 2014).\n\n#knitr::include_graphics('./img/fig4.jpg')\n\nTo assess whether shape and size differs by ColorGroup, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\n#knitr::include_graphics('img/fig5.jpg')"
  },
  {
    "objectID": "c01-color.html",
    "href": "c01-color.html",
    "title": "Color",
    "section": "",
    "text": "# compare colors\nlibrary(here)\nlibrary(colordistance)\nlibrary(recolorize)\nlibrary(tidyverse)\nlibrary(vegan)\nlibrary(ape)\nlibrary(ggConvexHull)\nlibrary(wesanderson)\n\n# get image paths\nimages <- colordistance::getImagePaths('out')\n\n# generate color distance matrix\ncdm <- imageClusterPipeline(images)\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n\n# replace NAs with 0\ncdm[is.na(cdm)] = 0\n# export color distance matrix\nwrite.csv(cdm, file = \"distance_matrix.csv\")\n\n# import qual data\nhfesp.data <- read.csv('qdata.csv',\n                   header = TRUE,\n                   as.is = TRUE)\n\n# import color distance matrix\nc.data <- read.csv(\"distance_matrix.csv\",\n                   header = TRUE,\n                   as.is = TRUE)"
  },
  {
    "objectID": "c01-color.html#ordination-nmds",
    "href": "c01-color.html#ordination-nmds",
    "title": "Color",
    "section": "Ordination: NMDS",
    "text": "Ordination: NMDS\n\nnmds_scores <- scores(metaMDS(comm = as.dist(cdm)))\n\nRun 0 stress 0.03055757 \nRun 1 stress 0.03054082 \n... New best solution\n... Procrustes: rmse 0.005812862  max resid 0.02626052 \nRun 2 stress 0.03725666 \nRun 3 stress 0.04214093 \nRun 4 stress 0.03817891 \nRun 5 stress 0.03059301 \n... Procrustes: rmse 0.006783254  max resid 0.02898219 \nRun 6 stress 0.03058271 \n... Procrustes: rmse 0.006509488  max resid 0.02844272 \nRun 7 stress 0.03382293 \nRun 8 stress 0.033832 \nRun 9 stress 0.03392045 \nRun 10 stress 0.03704332 \nRun 11 stress 0.0371812 \nRun 12 stress 0.03595629 \nRun 13 stress 0.03118309 \nRun 14 stress 0.03376344 \nRun 15 stress 0.03868151 \nRun 16 stress 0.03704366 \nRun 17 stress 0.0383101 \nRun 18 stress 0.03376752 \nRun 19 stress 0.03895537 \nRun 20 stress 0.03382156 \n*** Best solution was not repeated -- monoMDS stopping criteria:\n    10: no. of iterations >= maxit\n    10: stress ratio > sratmax\n\nplot <- scores(nmds_scores) %>% \n  as_tibble(rownames = 'X') %>%\n  inner_join(., hfesp.data, by = 'X')\n\n## plot\nggplot(data = plot, aes(x = NMDS1, y = NMDS2, \n                        color = ColorGroup, fill = ColorGroup)) +\n  geom_point(aes(shape = ColorGroup)) +\n  geom_convexhull(alpha = 0.1) +\n  scale_color_manual(values = wes_palette('Moonrise2')) +\n  scale_fill_manual(values = wes_palette('Moonrise2')) +\n  theme(legend.position = 'none')\n\n\n\n# perMANOVA\nbottle <- left_join(hfesp.data, c.data, by = 'X') # left join by specimen number\nbottle.dist <- bottle[,6:35] # color distance matrix\nset.seed(10) # make results reproducible\n\n# model: color as a function of firing category (oxidized v. reduced)\nbottle.colour <- adonis2(bottle.dist ~ ColorGroup,\n                         data = bottle,\n                         permutations = 10000,\n                         method = 'bray')\n\n## does color differ by firing category?\nbottle.colour\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 10000\n\nadonis2(formula = bottle.dist ~ ColorGroup, data = bottle, permutations = 10000, method = \"bray\")\n           Df SumOfSqs      R2      F    Pr(>F)    \nColorGroup  1  0.55517 0.31881 13.105 9.999e-05 ***\nResidual   28  1.18618 0.68119                     \nTotal      29  1.74135 1.00000                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "c01-color.html#visualization-tree",
    "href": "c01-color.html#visualization-tree",
    "title": "Color",
    "section": "Visualization: Tree",
    "text": "Visualization: Tree\n\n# define add_image function\nadd_image <- function(obj,\n                      x = NULL,\n                      y = NULL,\n                      width = NULL,\n                      interpolate = TRUE,\n                      angle = 0) {\n  \n  # get current plotting window parameters:\n  usr <- graphics::par()$usr\n  pin <- graphics::par()$pin\n  \n  # image dimensions and scaling factor:\n  imdim <- dim(obj)\n  sf <- imdim[1] / imdim[2]\n  \n  # set the width of the image (relative to x-axis)\n  w <- width / (usr[2] - usr[1]) * pin[1]\n  h <- w * sf\n  hu <- h / pin[2] * (usr[4] - usr[3])\n  \n  # plot the image\n  graphics::rasterImage(image = obj,\n                        xleft = x - (width / 2), xright = x + (width / 2),\n                        ybottom = y - (hu / 2), ytop = y + (hu/2),\n                        interpolate = interpolate,\n                        angle = angle)\n}\n\n# neighbor-joining tree----\ntree <- nj(as.dist(cdm))\n# plot tree\nplot(tree,\n     show.tip.label = FALSE,\n     direction = \"upward\")\n\n# get parameters from plotting environment\nlastPP <- get(\"last_plot.phylo\", \n              envir = .PlotPhyloEnv)\n\n# get xy coordinates of tips\nntip <- lastPP$Ntip\n\n# first n values are tips/remaining values are node coordinates\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip])\n\n# get image names\nimnames <- tools::file_path_sans_ext(basename(images))\n\n# get tip labels\ntipnames <- tree$tip.label\n\n# check that images are in correct order:\nimage_order <- match(tipnames, imnames)\nimages <- images[image_order]\n\n## final plot\npar(mar = rep(0, 4))\nplot(tree, show.tip.label = FALSE, direction = \"upward\")\n\n# parameters from plotting environment\nlastPP <- get(\"last_plot.phylo\", envir = .PlotPhyloEnv)\n\n# xy coordinates of tips\nntip <- lastPP$Ntip\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip]) \n\nfor (i in 1:length(images)) {\n  add_image(png::readPNG(images[i]),\n            x = xy[i, 1],\n            y = xy[i, 2], \n            width = 2)\n}"
  },
  {
    "objectID": "c02-morphology.html",
    "href": "c02-morphology.html",
    "title": "Morphology",
    "section": "",
    "text": "# load required analysis packages\nlibrary(here)\nlibrary(StereoMorph)\nlibrary(geomorph)\nlibrary(tidyverse)\nlibrary(wesanderson)\nlibrary(ggplot2)\n\n## load GM data----\nsource('readmulti.csv.R')\n\n# read .csv files\nsetwd(\"./data\")\nfilelist <- list.files(pattern = \".csv\")\ncoords <- readmulti.csv(filelist)\nsetwd(\"../\")\n\n# read qualitative data\nqdata <- read.csv(\"qdata.csv\", \n                  header = TRUE, \n                  row.names = 1)\nqdata <- qdata[match(dimnames(coords)[[3]], rownames(qdata)),]"
  },
  {
    "objectID": "c02-morphology.html#generalised-procrustes-analysis",
    "href": "c02-morphology.html#generalised-procrustes-analysis",
    "title": "Morphology",
    "section": "Generalised Procrustes Analysis",
    "text": "Generalised Procrustes Analysis\nLandmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Rohlf and Slice 1990) performed in R (R Core Development Team, 2023) using the geomorph library (Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001).\n\n# gpa ----\nY.gpa <- gpagen(coords, print.progress = FALSE)\n\n# plot\nplot(Y.gpa)\n\n# geomorph data frame ----\ngdf <- geomorph.data.frame(shape = Y.gpa$coords, \n                           size = Y.gpa$Csize,\n                           ColorGroup = qdata$ColorGroup)\n\n# add centroid size to qdata\nqdata$csz <- Y.gpa$Csize"
  },
  {
    "objectID": "c02-morphology.html#boxplot-centroid-size",
    "href": "c02-morphology.html#boxplot-centroid-size",
    "title": "Morphology",
    "section": "Boxplot (centroid size)",
    "text": "Boxplot (centroid size)\n\n# attributes\ncsz <- qdata$csz\nColorG <- qdata$ColorGroup\n\n# palette\npal = wes_palette(\"Moonrise2\")\n\n# boxplot of Perdiz arrow points by region\nggplot(qdata, aes(x = ColorG, y = csz, color = ColorG)) +\n  geom_boxplot() +\n  geom_dotplot(binaxis = 'y', stackdir = 'center', dotsize = 0.3) +\n  scale_color_manual(values = pal) +\n  theme(legend.position = \"none\") +\n  labs(x = 'ColorGroup', y = 'Centroid Size')\n\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`."
  },
  {
    "objectID": "c02-morphology.html#principal-components-analysis",
    "href": "c02-morphology.html#principal-components-analysis",
    "title": "Morphology",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\nPrincipal components analysis (Jolliffe 2002) was used to visualise shape variation among the Perdiz arrow points. The shape changes described by each principal axis are commonly visualized using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014).\n\n# principal components analysis ----\npca<-gm.prcomp(Y.gpa$coords)\nsummary(pca)\n\n\nOrdination type: Principal Component Analysis \nCentering by OLS mean\nOrthogonal projection of OLS residuals\nNumber of observations: 25 \nNumber of vectors 24 \n\nImportance of Components:\n                             Comp1      Comp2        Comp3        Comp4\nEigenvalues            0.008692318 0.00367751 0.0009941785 0.0006335139\nProportion of Variance 0.598173607 0.25307283 0.0684157358 0.0435961133\nCumulative Proportion  0.598173607 0.85124644 0.9196621728 0.9632582861\n                              Comp5        Comp6        Comp7        Comp8\nEigenvalues            0.0001821203 9.131552e-05 7.841277e-05 7.224262e-05\nProportion of Variance 0.0125328534 6.284001e-03 5.396080e-03 4.971474e-03\nCumulative Proportion  0.9757911395 9.820751e-01 9.874712e-01 9.924427e-01\n                              Comp9       Comp10       Comp11       Comp12\nEigenvalues            4.313384e-05 1.884719e-05 1.557754e-05 7.427879e-06\nProportion of Variance 2.968313e-03 1.296995e-03 1.071990e-03 5.111595e-04\nCumulative Proportion  9.954110e-01 9.967080e-01 9.977800e-01 9.982912e-01\n                             Comp13       Comp14       Comp15       Comp16\nEigenvalues            6.172579e-06 4.604114e-06 4.149235e-06 2.210293e-06\nProportion of Variance 4.247744e-04 3.168383e-04 2.855352e-04 1.521043e-04\nCumulative Proportion  9.987159e-01 9.990328e-01 9.993183e-01 9.994704e-01\n                             Comp17       Comp18       Comp19       Comp20\nEigenvalues            2.000337e-06 1.773901e-06 1.233276e-06 9.874623e-07\nProportion of Variance 1.376559e-04 1.220734e-04 8.486958e-05 6.795356e-05\nCumulative Proportion  9.996081e-01 9.997301e-01 9.998150e-01 9.998830e-01\n                             Comp21       Comp22       Comp23       Comp24\nEigenvalues            7.968780e-07 4.771590e-07 2.891647e-07 1.376028e-07\nProportion of Variance 5.483824e-05 3.283634e-05 1.989926e-05 9.469320e-06\nCumulative Proportion  9.999378e-01 9.999706e-01 9.999905e-01 1.000000e+00\n\n# set plot parameters\npch.gps <- c(1,3)[as.factor(qdata$ColorGroup)]\ncol.gps <- wes_palette(\"Moonrise2\")[as.factor(qdata$ColorGroup)]\ncol.hull <- c(\"#C27D38\",\"#798E87\")\n\n# plot pca by merged\npc.plot <- plot(pca, \n                asp = 1,\n                pch = pch.gps,\n                col = col.gps)\nshapeHulls(pc.plot, \n           groups = qdata$ColorGroup,\n           group.cols = col.hull)\n\n\n\n# plot x/y maxima/minima\n## x - minima\nmean.shape <- mshape(Y.gpa$coords)\nplotRefToTarget(pca$shapes$shapes.comp1$min, \n                mean.shape)\n\n\n\n## x - maxima\nplotRefToTarget(pca$shapes$shapes.comp1$max, \n                mean.shape)\n\n\n\n## y - minima\nplotRefToTarget(pca$shapes$shapes.comp2$min, \n                mean.shape)\n\n\n\n## y - maxima\nplotRefToTarget(pca$shapes$shapes.comp2$max, \n                mean.shape)"
  },
  {
    "objectID": "c02-morphology.html#procrustes-anova",
    "href": "c02-morphology.html#procrustes-anova",
    "title": "Morphology",
    "section": "Procrustes ANOVA",
    "text": "Procrustes ANOVA\nTo assess whether shape and size differ by size class, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\n# ANOVA ----\n# shape\nfit.sh <- procD.lm(shape ~ ColorGroup,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# shape as a function of ColorGroup/raw material?\nanova(fit.sh)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n           Df      SS       MS     Rsq      F      Z Pr(>F)  \nColorGroup  1 0.04246 0.042462 0.12175 3.1886 1.7758 0.0372 *\nResiduals  23 0.30629 0.013317 0.87825                       \nTotal      24 0.34875                                        \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCall: procD.lm(f1 = shape ~ ColorGroup, iter = 9999, data = gdf, print.progress = FALSE)\n\n# size\nfit.sz <- procD.lm(size ~ ColorGroup,\n                   data = gdf,\n                   print.progress = FALSE,\n                   iter = 9999)\n\n# size as a function of ColorGroup/raw material?\nanova(fit.sz)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n           Df     SS      MS     Rsq     F        Z Pr(>F)\nColorGroup  1   4695  4695.3 0.00836 0.194 -0.39863 0.6539\nResiduals  23 556685 24203.7 0.99164                      \nTotal      24 561381                                      \n\nCall: procD.lm(f1 = size ~ ColorGroup, iter = 9999, data = gdf, print.progress = FALSE)"
  },
  {
    "objectID": "c02-morphology.html#mean-shapes",
    "href": "c02-morphology.html#mean-shapes",
    "title": "Morphology",
    "section": "Mean shapes",
    "text": "Mean shapes\n\n# subset landmark coordinates to produce mean shapes for contexts\nnew.coords <- coords.subset(A = Y.gpa$coords,\n                            group = qdata$ColorGroup)\nnames(new.coords)\n\n[1] \"A\" \"B\"\n\n## plot shape means\nmean <- lapply(new.coords, mshape)\nplot(mean$A)\nplot(mean$B)\n\n# comparison plots\nplotRefToTarget(mean$A,\n                mean$B, \n                method = \"points\",\n                mag = 1)\n\n#knitr::include_graphics('img/fig5.jpg')"
  }
]